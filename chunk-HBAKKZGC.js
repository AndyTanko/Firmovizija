import{e as w,j as H}from"./chunk-FK46AHMU.js";import{a as J,b as K}from"./chunk-347TNHNH.js";import{a as P,b as V,c as z,d as E,e as R,f as j,g as A,h as L,i as G,j as $,k as B,l as W,m as q,n as U}from"./chunk-7RE6NJWP.js";import{$ as _,Da as v,Ha as x,Oa as m,Qa as F,Ra as T,Sa as h,Ta as y,Ua as l,Va as p,Wa as S,Xa as k,Ya as u,Za as s,_ as C,_a as O,aa as b,cb as c,db as f,fb as M,gb as D,hb as I,va as n,yb as N,za as d}from"./chunk-7B7TQYSA.js";var X=(r,o)=>o[0];function Y(r,o){if(r&1&&(l(0,"option",2),c(1),p()),r&2){let e=o.$implicit;m("value",e),n(),f(e)}}function Z(r,o){if(r&1&&S(0,"input",7),r&2){let e=s().$implicit;m("type",e[1].type)("placeholder",e[1].placeholder)("id",e[0])("formControlName",e[0])}}function ee(r,o){if(r&1){let e=k();l(0,"input",10),u("change",function(i){_(e);let a=s().$implicit,g=s();return b(g.handleFileInput(i,a[0]))}),p()}if(r&2){let e=s().$implicit;m("placeholder",e[1].placeholder)("id",e[0])("formControlName",e[0])}}function te(r,o){if(r&1&&(l(0,"p",9),c(1),p()),r&2){let e=s().$implicit;n(),f(e[1].errorMessage)}}function oe(r,o){if(r&1&&(l(0,"label",6),c(1),p(),x(2,Z,1,4,"input",7)(3,ee,1,3,"input",8)(4,te,2,1,"p",9)),r&2){let e,t=o.$implicit,i=s();O("for",t[1].label),n(),f(t[1].label),n(),F(t[1].type!=="file"?2:3),n(2),F((e=i.form.get(t[0]))!=null&&e.invalid&&((e=i.form.get(t[0]))!=null&&e.touched||(e=i.form.get(t[0]))!=null&&e.dirty)?4:-1)}}var Q=class r{constructor(o,e,t){this.router=o;this.apiService=e;this.fb=t;let i={};this.formDict.forEach(([a,g])=>{g.type!=="file"||(this.selectedFiles[a]=null)}),this.form=this.fb.group(i)}initialTypeFromRoute;options=["Preduzetnik","D.O.O."];opt="Preduzetnik";dict={Preduzetnik:J,"D.O.O.":K};get formDict(){let o=this.dict[this.opt];return o?Object.entries(o):[]}selectedFiles={};form;defaultFormType="Preduzetnik";preselectedType=this.defaultFormType;get currentFormType(){return this.form.get("formType")?.value}ngOnInit(){this.opt=this.initialTypeFromRoute||this.defaultFormType,this.buildForm()}ngOnChanges(o){o.initialTypeFromRoute&&o.initialTypeFromRoute.currentValue!==o.initialTypeFromRoute.previousValue&&(this.opt=o.initialTypeFromRoute.currentValue||this.defaultFormType,this.buildForm())}getValidators(o){let e=[];if(o.validators)for(var t of o.validators)e.push(t);return e}onOptChange(){this.buildForm()}buildForm(){let o={};for(let[e,t]of this.formDict)o[e]=this.fb.control(t.value,this.getValidators(t));this.form=this.fb.group(o)}handleFileInput(o,e){let i=o.currentTarget.files;i&&i.length>0?this.selectedFiles[e]=i[0]:this.selectedFiles[e]=null}onSubmit(){this.form.markAllAsTouched();let o=!0;if(this.formDict.forEach(([e,t])=>{t.type==="file"&&t.validators?.includes(V.required)&&(this.selectedFiles[e]||(console.warn(`File for ${e} is required.`),o=!1))}),this.form.valid&&o){let e=new FormData;for(let[t,i]of Object.entries(this.form.value))i!=null&&e.append(t,String(i));for(let t of Object.keys(this.selectedFiles)){let i=this.selectedFiles[t];i&&e.append(t,i,i.name)}this.apiService.upload("https://pzi9yg9hz5.execute-api.eu-central-1.amazonaws.com/Localhost/send",e).subscribe({next:t=>{console.log("Form Submitted Successfully:",t),this.router.navigate(["/home"]),alert("Uspe\u0161no ste poslali podatke! O\u010Dekujte email od nas uskoro.")},error:t=>{console.error("Error submitting form:",t)}})}else console.error("Form is invalid.")}static \u0275fac=function(e){return new(e||r)(d(w),d(H),d(W))};static \u0275cmp=v({type:r,selectors:[["app-form"]],inputs:{initialTypeFromRoute:[0,"type","initialTypeFromRoute"]},features:[C],decls:11,vars:3,consts:[[2,"font-family","sans-serif","padding","20px"],[1,"prettyinput",3,"ngModelChange","ngModel"],[3,"value"],[2,"display","flex","flex-direction","column","align-items","center"],[3,"ngSubmit","formGroup"],["type","submit",1,"cta-button",3,"disabled"],[1,"prettylabel",3,"for"],[1,"prettyinput",3,"type","placeholder","id","formControlName"],["type","file",1,"prettyinput",3,"placeholder","id","formControlName"],[2,"color","red"],["type","file",1,"prettyinput",3,"change","placeholder","id","formControlName"]],template:function(e,t){e&1&&(l(0,"div",0)(1,"h2")(2,"select",1),I("ngModelChange",function(a){return D(t.opt,a)||(t.opt=a),a}),u("ngModelChange",function(){return t.onOptChange()}),h(3,Y,2,2,"option",2,T),p()(),l(5,"div",3)(6,"form",4),u("ngSubmit",function(){return t.onSubmit()}),h(7,oe,5,4,null,null,X),l(9,"button",5),c(10,"Po\u0161alji"),p()()()()),e&2&&(n(2),M("ngModel",t.opt),n(),y(t.options),n(3),m("formGroup",t.form),n(),y(t.formDict),n(2),m("disabled",t.form.invalid))},dependencies:[N,q,j,$,B,P,G,z,E,R,U,A,L],styles:[".cta-button[_ngcontent-%COMP%]{background-color:#007bff;color:#fff;border:none;border-radius:5px;font-size:1.1rem;cursor:pointer;transition:background-color .3s ease;padding:1rem 2rem;margin:1rem}.cta-button[_ngcontent-%COMP%]:hover{background-color:#0056b3}.cta-button[_ngcontent-%COMP%]:disabled{background-color:#666;opacity:.5;cursor:not-allowed}.prettylabel[_ngcontent-%COMP%]{display:block;margin-bottom:5px;font-weight:700;color:#333;font-size:.9em}.prettyinput[_ngcontent-%COMP%]{display:block;width:100%;padding:10px;margin-bottom:15px;border:1px solid #ccc;border-radius:4px;box-sizing:border-box;font-size:1em}.prettyinput[_ngcontent-%COMP%]:focus{outline:none;border-color:#007bff;box-shadow:0 0 5px #007bff40}"]})};export{Q as FormComponent};
